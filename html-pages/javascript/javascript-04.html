<root data-root="JavaScript循环">
    <!-- 循环概述 -->
    <section class="mt0">
        <h3>JavaScript循环概述</h3>
        <p>和其它绝大部分编程语言一样，JavaScript也有自己的循环语句，循环语法结构上主要借鉴的是Java。循环语句全称“条件循环执行语句”，从名称就能看出来，它的执行也需要依耐条件，只有当条件满足时才会循环地去执行一段语句，直到条件不再满足时。但倘若这个条件永远无法满足（出现这样的情况通常是编码过程中对条件的把握不严谨或粗心造成的），那这个循环就会无限地执行下去，对计算机的性能消耗会非常大，直到计算机CPU消耗率达到100%，造成程序的<em title="类似操作系统的假死状态，当高耗程序对资源释放后系统又会重新运行起来">假死</em>，这样的循环语句通常称作<em>死循环</em>。</p>
        <p>条件判断语句，特别是“if语句”或许是最重要，最有用的条件语句了，但它的不足之处在于，它没有办法去完成一些需要重复的操作，特别是当这些重复性的操作数非常巨大时。而要完成大量重复的操作，只能使用循环语句了。</p>
        <p>之前提到过，循环语句可以让我们反复多次地运行同一段代码。循环语句分为几种不同的类型，但它们的工作原理几乎一样：只要给定条件仍能得到满足，包含在循环语句里的代码就将重复地执行下去，一旦条件得不到满足，即条件语句得出的结果不再为“true”时（这点和“if语句”是否执行一样），循环也就结束了。在JavaScript中，循环也分为<em>单次结束</em>和<em>完全结束</em>两种，这在我们本章中会讲到。我们首先来看一个循环执行的例子：</p>
        <p class="noindent"><a href="html-pages/javascript/codeEffect/code-001.html" target="_blank">HTML</a>部分的代码：</p>
        <code>
            <img src="img/code/jscode/code-js-031.jpg">
        </code>
        <p class="noindent">JavaScript部分代码。首先，仿真出一个“物流信息”的数据对象（在生产环境中，这样的数据都是从数据库获得的）：</p>
        <code>
            <img src="img/code/jscode/code-js-032.jpg">
        </code>
        <p class="noindent">然后，我们添加这样一个循环添加“物流信息”的函数：</p>
        <code>
            <img src="img/code/jscode/code-js-033.jpg">
        </code>
        <p class="noindent">最后，我只需要为id为“runForBtn”的按钮添加一个点击事件，让按钮被点击之后去调用执行之前所定义的这个函数即可：</p>
        <code>
            <img src="img/code/jscode/code-js-034.jpg">
        </code>
        <h4>运行效果：</h4>
        <iframe data-iframe-coderun class="codeEffect" src="html-pages/javascript/codeEffect/code-001.html"></iframe>
        <p>上例中采用的是在JavaScript中使用最为最为广泛的“for条件循环语句”，通常我们简称为“for循环”，该语句在本章中会作为重点讲解。从上例中可以看到，HTML页面文件中本来只有一行数据，在点击可上方的“加载物流数据”按钮后数据才会完整显示出来，而下方的数据是通过循环“物流信息”这个对象，并通过JavaScript内置的“innerHTML”方法通过“自加赋值运算符”将我们拼接的字符串最终以“HTML格式”添加进表格并显示出来的。实际上页面中一开始就显示出的第一行数据信息是为了测试显示效果，实际生产环境中，表格中除了表头，表体是没有数据的。这些数据都是需要通过服务器端语言通过数据库去获取到（即常说的后台页面），然后前端通再通过Ajax等技术手段从后台页面去获取这些数据。（实际上现在的JavaScript已经能直接对数据库进行操作了，甚至还有直接在服务器端运行JavaScript的项目“nodeJS”）</p>
    </section>
    <!-- while循环 -->
    <section>
        <h3>while循环</h3>
        <p>“while循环”包括一个循环条件和一段代码块，它的基本语法结构与“if语句”基本完全一样，它们的区别在于，只要条件为真（true），就不断循环执行代码块。</p>
        <p>我们先来看一下“while循环”的简单代码示例：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-035.jpg">
        </code>
        <p>代码在运行后，Google Chrome浏览器开发者工具的的控制台中（以后在本课件中简称为“控制台”）输出的结构为：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-036.jpg">
        </code>
        <p>在这个过程中，一开始“count”这个变量的数值为“0”，进入while后面的括号内进行条件判断，“0&lt;5”条件成立，得出布尔值的结果“true”，然后进入循环体内部，执行“count++”（即：count = 0 + 1），经过计算后，此时的“count”的值已经变为“1”了，然后在控制台内输出结果。接着循环又将从while的地方开始，进入条件判断，“1&lt;5”条件成立，然后再次进行循环体依次按行去执行语句，以此类推。当“count”通过一次次的自加运算，值变为“5”的时候进行条件判断，“5&lt;5”条件不成立，返回布尔值结果“false”，跳出整个while循环执行后续的语句。</p>
        <p>为了说明while循环的原理，我们稍微改动一下之前的代码再来观察控制台的输出结果：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-037.jpg">
        </code>
        <p>然后我们在控制台会看到这样的结果：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-038.jpg">
        </code>
        <p>通过这个示例，基本完全应证了之前我们讲述的while循环的运行原理。那我们来思考一个问题，就是将上例代码while循环体内部的代码“count++”和“console.log("现在count的值是：" + count)”上下位置交换一下，在控制台得出的结果应该会是什么。</p>
        <p>关于循环语句，在这里需要补充注意的一点是，不到万不得已千万不要在循环体内部（即循环花括号“{...}”内部）去声明变量，除非有很特别的用途（如临时存储一个复杂值）。因为循环的每次执行都会都会从新执行一次循环体内部的代码，也就是说声明在循环体内部的变量每次都会被从新声明一次（类似于重置效果），这样一来就很难让变量得到预计的值。不仅“while循环”是这样，后面将会讲到的每种循环方式都是同样的道理。</p>
    </section>
    <!-- 章节练习 -->
    <section class="unitPractice">
        <h3>&lt;章节练习一&gt;</h3>
        <p>编写一个“while循环”，在控制台中输出“0~100”之间的“奇数”。</p>
	</section>
	<!-- do while循环 -->
	<section>
	    <h3>do while循环</h3>
	    <p>类似于if语句的情况，while循环内语句有可能不被执行：因为循环的条件判断发生在每次循环开始之前，所以如果循环的条件判断求值结果是false，那循环体的代码是不会执行的。</p>
	    <p>在有些应用场景里，我们希望包含在循环体内的语句至少执行一次。这个时候“do while循环”就是我们最好的选择了。简单的理解就是，“while循环”先判断条件再决定是否执行，而“do while循环”执行一次循环体内的语句再判断条件。我们来看看“do while循环”的基本语法结构：</p>
	    <code class="indent">
            <img src="img/code/jscode/code-js-039.jpg">
        </code>
        <p>控制台中会输出结果：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-040.jpg">
        </code>
        <p>首先，注意“while(条件判断)”后面的分号“;”，一定要加上，之前“while循环”语句的结束是“}”所以不需要。其次，记忆良好的你也许会认为，这和之前“while循环”的输出结果没有任何一个字的不同，但你看到的只是现象。我们只需要做一个简单的实验就能发现差别，只需要把声明“count”变量时的那个数值“0”改成“5”，再分别去运行一次“while循环”和一次“do while循环”就立刻会发现它们之间最本质的差别了。</p>
	</section>
	<!-- for循环 -->
	<section>
	    <h3>for循环</h3>
	    <p>在现在的生产环境中，“for循环”是使用得最多的一种循环方式。这和它执行的性能和应用范围并没有关系。很多时候使用这个循环语句更多地考虑是，这种循环的声明方式是将变量名，条件判断和自增运算都放在了这个循环方法的括号内部。这样一来使得语法更加简洁明了，即省掉了声明变量的作用注释，在阅读代码时让独立在循环体外部的变量对我们的判断产生干扰。同时这样也最大程度地避免了循环的异常——忘记在循环体内部加上变量的自增语句而导致的“死循环”。</p>
	    <p>我们首先来看“for循环”的基本语法结构：</p>
	    <code class="indent">
            <img src="img/code/jscode/code-js-041.jpg">
        </code>
        <p>控制台中输出的结果为：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-042.jpg">
        </code>
        <p>和我们之前看到过的“while系列循环”不一样，这次的循环条件内多了好多内容。其实“for循环”只是将循环体外部独立声明的变量和循环体内部的变量自增运算都放进了“for”后面的括号里，成为了一个“条件组合”，上例中“for循环”写成“while循环”就相当于：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-043.jpg">
        </code>
        <p>它得出的结果和上例“for循环”的结果完全一致，也是刚才要大家思考内容的正确结果。通过两段代码的示例图可以清晰地发现，“for循环”这种循环语句无论是在代码行数减少方面，还是在结构说明上都会好很多，所以也是今后使用的最多的一种循环语句。本章中的第一个示例，就是用for循环实现的。</p>
        <p>“for循环”内也能同时定义多个变量来应付一些特殊的需求，如：定义一个人员名单的数组，当发现至指定人员姓名时，将其姓名在控制台内进行输出，若满足一个数量要求后再给出一定的提示。这种做法通常是用于查询某个大型数组内是否存在某个值或某几个值的一种做法。</p>
        <code>
            <img src="img/code/jscode/code-js-044.jpg">
        </code>
        <p>上方的代码最后会在控制台内输出注释中所列的结果。当然这里的数组访问和数组的长度还不是我们已经接触到过的内容，这里可以简单地理解为：数组的下标是是从0开始的，上例中的对应关系就是“0:路飞”、“1:索隆”...“8:布鲁克”以此类推。在“for循环”内部除了一个接收当前数组值的“name”变量，还有一个变量“j”，这个变量在这里的作用是一个<em>计数器</em>，指满足一定条件后，自身会“+1”。计数器的用法通常是，当它的值达到某一个指定值时做出某项行为。计数器在处理一些复杂的情况时对功能的实现特别的简单有效。</p>
	</section>
	<!-- 章节练习 -->
    <section class="unitPractice">
        <h3>&lt;章节练习二&gt;</h3>
        <p>将“章节练习一”中的要求用“for循环”进行实现。</p>
	</section>
	<!-- 循环语句的嵌套 -->
	<section>
	    <h3>循环语句的嵌套</h3>
	    <p>在讲解“while循环”的时候，我们就提到过，循环这种语句和之前所讲到的条件判断语句十分相似，特别是“if语句”，不同之处在于：当条件成立时，条件判断语句只执行1次，而循环语句会执行1次或多次。</p>
	    <p>它们的相似之处不仅此而已，条件判断语句能够进行嵌套，循环语句同样能进行嵌套。循环语句通过嵌套可以解决一些有规律的复杂性的重复性工作，如我们在小学期间就学习过的“九九乘法表”。</p>
	    <p>HTML部分没有任何关于显示效果的标签，JavaScript代码如下：</p>
	    <code class="indent">
            <img src="img/code/jscode/code-js-045.jpg">
        </code>
        <h4>经过CSS进件美化处理后，运行效果如下：</h4>
        <iframe data-iframe-coderun class="codeEffect" src="html-pages/javascript/codeEffect/code-002.html"></iframe>
        <p>如果不了解循环运作的原理，一开始看到这样的结果必然不理解，实际在理解上，嵌套循环和在一个函数里再嵌套一个函数非常类似。可以把循环看成一个主流程上的点，主循环（外层的循环）形成一个环状的流程，循环的开始点和结束点和主流程想交，而子循环（内层的循环）又单独形成一个环，子循环的开始点和结束点又和外层循环上的某个点想交。每次子循环结束的时候，又会回到子循环内，进行新一轮的条件循环，当主循环的条件再次得到的值为真的时候，又会根据条件判断语句（如果有的话）是否决定再次进入子循环，以此类推。</p>
        <code>
            <img src="img/content/javascript/circulationTheory.jpg">
        </code>
	</section>
	<!-- 循环语句的中断和跳出 -->
	<section>
	    <h3>循环语句的中断和跳出</h3>
	    <p>在JavaScript的循环语句中，当循环满足了一定的条件后可以中断或跳出循环，类似于“switch-case语句”，但却“丰富”很多，控制循环语句中断或跳出的关键字有三个：“continue”、“break”（和“switch-case语句”中的“break”作用基本相同）和“return”。它们的作用都是当循环执行到该关键字的时候中断当前循环，但在实际使用中存在着很明显的区别，接下来我们就来对它们的特性进行学习。</p>
	    <dl class="attrExplain">
	        <dt>continue——单次循环跳出</dt>
	        <dd>该关键词的作用是当循环满足一定条件之后结束该轮循环，进入到下一轮循环。该关键词一般出现在条件判断语句内，满足一些筛选功能的需求，如下例：</dd>
	        <dd>
                <code>
                    <img src="img/code/jscode/code-js-054.jpg">
                </code>
	        </dd>
            <dd>程序运行后在控制台中输出的结果如下：</dd>
            <dd>
                <code>
                    <img src="img/code/jscode/code-js-055.jpg">
                </code>
            </dd>
            <dd>稍微仔细一点可以发现，包含在数组中的人员“刘子章”并没有在控制台中输出，但这却不妨碍“刘子章”之前和之后的人员姓名的输出，这就是“continue”在这里所起的作用。</dd>

            <dt>break——跳出整个循环</dt>
            <dd>如果一个产品的用户量比较大，那所产生的信息数据自然不会小，这些信息很多时候的存在方式都是一个“数组”，当数组内容量特别巨大，但又想在数组内查找某一项数据，又不希望其它数据干扰的时候，使用关键字“break”将是一个不错的选择，如下例：</dd>
            <dd>
                <code>
                    <img src="img/code/jscode/code-js-056.jpg">
                </code>
	        </dd>
            <dd>程序运行后在控制台中输出的结果如下：</dd>
            <dd>
                <code>
                    <img src="img/code/jscode/code-js-057.jpg">
                </code>
            </dd>
            <dd>其实，44的数组长度在很多拥有大量用户产品的数据库内只是个零头都算不上的数字，如国内“腾讯”、“阿里巴巴”、“京东”、“网易”、“搜狐”、“奇虎360”、“中国移动”、“中国电信”等这些互联网、通讯企业，他们的用户都是数以万计的。如果应用户的要求，需要在数据库内查找某条信息，如果是通过循环方式去查找的，又不去使用类似于“break”这种功能，那造成的硬件资源和时间成本的浪费都是非常巨大的。</dd>

            <dt>return——跳出整个函数</dt>
            <dd>return这个关键字不仅为函数返回一个需要的值，以用于被某个变量接收用于程序的其它操作，它在一个循环语句里也同样能够使用。当需要返回特定的值的时候，可以在return加空格后返回<em>一个</em>值（而且只能是一个值，包括一个对象），返回该值后程序结束，即函数内return关键字之后的代码都不会执行，如果是在全局环境，那全局return之后的代码同样不会执行（通常不会这样做）。如果不返回任何值而单独使用的话，它起到的作用就只限于一个“中断跳出”作用。</dd>
            <dd>需要注意的是<em>循环是没有自己的作用域</em>的，循环内定义的变量同样属于自己所在的父级作用域（函数或者全局），也就是说如果return关键字出现之后同样能起到一个中断后续代码的作用，包括正在进行的循环。</dd>
            <dd>先来看一个函数运行后通过return返回值的例子：</dd>
            <dd>
                <code>
                    <img src="img/code/jscode/code-js-267.jpg">
                </code>
            </dd>
            <dd>函数被调用后，在控制台中输出的结果为：</dd>
            <dd>
                <code>
                    <img src="img/code/jscode/code-js-268.jpg">
                </code>
            </dd>
            <dd>函数testReturn()中最后本应在控制台输出的“这是一个return返回值的例子”由于return出现的中断作用没有得到执行。再看一个return出现在循环语句中的例子：</dd>
            <dd>
                <code>
                    <img src="img/code/jscode/code-js-269.jpg">
                </code>
            </dd>
            <dd>函数被调用后，在控制台中输出的结果为：</dd>
            <dd>
                <code>
                    <img src="img/code/jscode/code-js-270.jpg">
                </code>
            </dd>
            <dd>函数testForReturn()内的if语句相当于是一个前置判断，当条件成立时才会返回特定的结果“str + ！”，也就是说如果这个条件不成立时，数组内的元素应该全部会添加进“str”这个变量，而且函数的返回值应该为默认隐式设置的undefined。而且一旦return得到执行，函数会立即中止，并返回值，所以不要企图用一个循环来多次通过return来返回一个值。</dd>
            <dd>关于return使用的作用域需要特别注意的是，return这个关键字<em>不能出现在全局作用域里</em>，否则浏览器会报错。</dd>
            <dd>
                <code>
                    <img src="img/code/jscode/code-js-291.jpg">
                </code>
            </dd>
	    </dl>
	</section>
	<!-- 中断和跳出的标签 -->
	<section>
	    <h3>中断和跳出标签</h3>
	    <p>在循环语句里还有一种特殊的语法前缀，称作<em>循环标签</em>。continue和break关键字起到的作用都是不再执行循环体内的后续语句，区别是前者会进行下一次，而后者不会。除此之外，它们还有一个共同点是都是结束当前层级的循环的代码（这有点像是超链接标签&lt;a&gt;的target属性中的“_parent”值，回到父级框架），而“循环标签”的作用是指定这次函数的中断和跳出可以到指定的某一层（当循环多层嵌套时）。</p>
	    <p>循环标签和对一个变量命名一样，可以自定义满足变量名命名规则的名称，同样注意是避免使用关键字和保留字，也不应该出现一些特殊符号和以数字作为命名的开头。</p>
	    <code class="indent">
			<img src="img/code/jscode/code-js-271.jpg">
		</code>
		<p>函数被调用后，在控制台中输出的结果为：</p>
		<code class="indent">
			<img src="img/code/jscode/code-js-272.jpg">
		</code>
		<p>如果你对循环嵌套的执行原理以及continue的作用了解了的话，经过一步步的拆分分析不难理解程序输出的结果。循环标签通常使用得不是非常多，只有在完成某些特定复杂的需求的时候才会去使用，如果能掌握，那在完成一些复杂的循环功能需求的时候，可能会是一个不小的帮助。break关键字同样能使用标签，原理和使用continue是一样的，这里就不再举例。</p>
	</section>
	<!-- for in循环 -->
	<section>
	    <h3>for in循环遍历</h3>
	    <p>虽然从名称上来看，“循环<em>遍历</em>”有“循环”二字，完全是有“for”这个关键字的存在，习惯性地把它称作“循环”。实际上该语句准确的叫法为“for in遍历语句”，因为这种“遍历”本身就是一种循环的方式，何为“遍历”？该词语出自于“<em>数据结构</em>”这一门计算机技术的专业术语，“二叉树”的遍历算法是“数据结构”的一个比较核心的算法之一，在“数据结构”中的“二叉树遍历”有多种算法，如“先序遍历”、“中序遍历”、“后序遍历”和“层序遍历”。</p>
	    <p>我们来看一个“数据结构”中的“先序遍历”作为对遍历的一种了解，这种遍历方式也是以前很多程序采用遍历的方式，是一种比较基础的遍历方式。</p>
	    <code class="indent">
            <img src="img/content/javascript/preorderTraversal.jpg">
        </code>
        <p>而在我们JavaScript中的“for in”遍历采用的是“层序遍历”的方式，即每次遍历只会对有同级关系的对象进行遍历，如果要进行后续遍历必须要以主对象作为遍历对象进行下一层的遍历。也就是说，如果对象内的某个属性的值为一个“object”型（对象数据类型），要遍历这个属性需要进行下一次遍历进行<em>键</em>或<em>值</em>的获取。</p>
        <p>在JavaScript中不存在“数组”这种数据类型，它分属于“object”这种数据类型，而“for in遍历”本身就是针对这种类型进行遍历的语句。“数组”作为对象中最简单的一种数据结构。我们首先看看看这样一个对“数组”进行遍历的例子：</p>
        <code>
            <img src="img/code/jscode/code-js-046.jpg">
        </code>
        <p>看到这样的结果可能你无法一时理解，循环中的“x”是什么，“y”又是什么，那我们将刚才那个“数组”直接复制到控制台中进行输出，观察这个“数组”展开之后的内容。</p>
        <code>
            <img src="img/code/jscode/code-js-047.jpg">
        </code>
        <p>可以看到，一个数组在输出展开后，每个数组内的值前面都有一个类似“属性”一样的数字，这个数字在数组中被称为数组元素的“<em title="程序语言中一种从0开始的计数方式">下标</em>”，而在最后有一个“length”属性，它的值即为当前数组内元素的个数。看到这样的结果后我们再去看之前的那段“for in遍历”，小括号中的条件“x”和"y"实际上就是这个数组“arr”的下标，而“arr”中的“length”属性的值直接决定了这个遍历将进行多少次（虽然这在代码中无法直接看到）。所以，代码中的“(x in arr)”可以理解为“arr”中的第几个“x”，输出的结果就是“x”本身，也就是数组元素对应的下标。</p>
        <p>第二个“for in遍历语句”中控制台输出的内容“arr[y]”，实际上指的就是“arr”数组中对应的第“y”个数组元素，所以它能够直接将对应下标的数组元素内容给输出出来。</p>
        <p>如果你对“for in遍历”遍历数组的这种方式已经理解了，那我们接下来看这种遍历方式对一个“纯对象”的遍历方式。它的原理和数组基本是一样的，不过只是将数组中的“下标”给替换为了“属性”（键），将数组中的“数组元素”给替换为了“属性值”（值）而已：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-048.jpg">
        </code>
        <p>程序运行后在控制台中输出的结果为：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-049.jpg">
        </code>
        <p>这里相当于只是输出了对象中的“属性”，并没有输出每个属性所对应的“属性值”。若要输出的内容为“属性值”，即我们在程序中正常情况下所使用的“对象内容”（和使用一个“变量”类似），需要和对数组元素的取值一样，写成以下形式：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-050.jpg">
        </code>
        <p>在控制台中得到的结果就为：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-051.jpg">
        </code>
        <p>但我们可以发现，其中的一个值仍然是一个对象，那是因为属性名为“caseAndPower”（机箱电源）的属性值本身就是一个对象，因此，若要将其值中的属性名也输出出来，就需要这样去写：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-052.jpg">
        </code>
        <p>在控制台中输出的结果为：</p>
        <code class="indent">
            <img src="img/code/jscode/code-js-053.jpg">
        </code>
        <p>那如果要将所有的属性值（包括子属性的属性值）都获取到应该怎么做呢？我们可以通过完成“章节练习三”去进行思考体会，真正了解“for in循环遍历”的使用方式。</p>
        <!-- 章节练习 -->
        <section class="unitPractice">
            <h3>&lt;章节练习三&gt;</h3>
            <p>1、仿照上面的“电脑基本硬件信息”声明一个同样结构的变量；</p>
            <p>2、将所有的属性值和属性值中的子属性的属性值全部输出在控制台里。</p>
        </section>
	</section>
</root>






